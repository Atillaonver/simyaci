{{ header }}{{ column_left }}
<div id="content">
	<div class="page-header">
		<div class="container-fluid">
			<div class="page-ctrl-controls" data-iwidth="" data-owidth=""><a href="{{ add }}" data-bs-toggle="tooltip" title="{{ button_add }}" class="btn btn-primary"><i class="fa-solid fa-plus"></i></a>
				<button type="submit" form="form-member" formaction="{{ delete }}" data-bs-toggle="tooltip" title="{{ button_delete }}" onclick="return confirm('{{ text_confirm }}');" class="btn btn-danger"><i class="fa-regular fa-trash-can"></i></button>
			</div>
			<h1>{{ heading_title }}</h1>
			<ol class="breadcrumb">
				{% for breadcrumb in breadcrumbs %}
					<li class="breadcrumb-item"><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
				{% endfor %}
			</ol>
		</div>
	</div>
	<div class="container-fluid">
		<div class="row">
      <div id="filter-art" class="col-lg-3 col-md-12 order-lg-last d-none d-lg-block mb-3">
        <div class="card">
          <div class="card-header"><i class="fa-solid fa-filter"></i> {{ text_filter }}</div>
          <div class="card-body">
            <div class="mb-3">
              <label for="input-name" class="form-label">{{ entry_name }}</label>
              <input type="text" name="filter_name" value="{{ filter_name }}" placeholder="{{ entry_name }}" id="input-name" data-oc-target="autocomplete-name" class="form-control" autocomplete="off"/>
              <ul id="autocomplete-name" class="dropdown-menu"></ul>
            </div>
            <div class="mb-3">
            	<div class="input-group row">
	            	<label for="input-status" class="form-label col-sm-7">{{ text_item_status }}</label> 
	            	<div class="form-check form-switch form-switch-lg col-sm-3" style="">
	                        <input type="checkbox" name="filter_status" value="1" id="input-status" class="form-check-input"{% if filter_status %} checked{% endif %}/>
	                </div>
                </div>
            </div>

             <div class="mb-3">
              <div class="input-group row">
              	<label for="input-all" class="form-label col-sm-7">{{ entry_pagination }}</label>
                <div class="form-check form-switch form-switch-lg col-sm-3" style="">
                   <input type="checkbox" name="filter_all" value="1" id="input-all" class="form-check-input"{% if filter_all %} checked{% endif %}/>
                </div>
            </div>
            </div>
            
            <div class="text-end">
              <button type="button" id="button-filter" class="btn btn-light"><i class="fa-solid fa-filter"></i> {{ button_filter }}</button>
            </div>
          </div>
        </div>
      </div>
      <div class="col col-lg-9 col-md-12">
		<div class="card">
			<div class="card-header"><i class="fa-solid fa-list"></i> {{ text_list }}</div>
			<div id="member" class="card-body">{{ list }}</div>
		</div>
	</div>
	</div>
</div>
<script type="text/javascript"><!--
$('#member').on('click', 'thead a, .pagination a', function (e) {
    e.preventDefault();
    $('#member').load(this.href);
});


$('#button-filter').on('click', function () {
    var url = '';

    var filter_name = $('#input-name').val();
    if (filter_name) {
        url += '&filter_name=' + encodeURIComponent(filter_name);
    }
	
	var filter_all = $('#input-all').prop( "checked" )
    if (filter_all) {
        url += '&filter_all=1';
    }

    var filter_status = $('#input-status').prop("checked");
    if (filter_status) {
        url += '&filter_status=1';
    }
    
    $('#member').load('index.php?route=bytao/member.list&user_token={{ user_token }}' + url,function(){
    	//$( "#sortable" ).sortable( "refresh" );
    	if (filter_all && !filter_name) {
    		if(!$('.list-header > .fa-people-carry').length){
    			$('.fa-list').before('<i class="fa red fa-people-carry"></i> ')
    		}
    		
    		$( "#sortable" ).addClass('sortable-results')
    		$( "#sortable" ).sortable({disabled: false});
    	}else{
    		$('.list-header > .fa-people-carry').remove();
    		$( "#sortable" ).removeClass('sortable-results')
    		$( "#sortable" ).sortable({disabled: true});
    	}
    	
    });
    
   
});


$(document).on('click', '#save-and-add', function (e) {
	alert()
    $('#save_and').val('1');
   	$('#saveFormBtn').trigger('click');
});

$("#sortable").sortable({
	placeholder: "ui-state-highlight",
	item:'tr',
	handle: "i.fa-up-down-left-right",
	helper:	'clone',
	item:'tr',
	update: function (item, container, _super) {
		var Olchild=$('#sortable tr');
		serials='';
		$(Olchild).each(function(){
				serials += $(this).attr('data-id')+'_'
			});
		$.ajax({
				url: 'index.php?route=bytao/member.sort&user_token={{ user_token }}',
				dataType: 'json',
				type:'post',
				data:{serial:serials},	
				success: function(json) {
					
				}
			});
	},
	serialize: function (parent, children, isContainer) {
		return isContainer ? children.join() : parent.attr('id');
	},
	tolerance: 6,
	distance: 10,
	activate: function( event, ui ) { 

	}
});

$("#sortable" ).sortable({disabled: true});

//--></script>
{{ footer }}